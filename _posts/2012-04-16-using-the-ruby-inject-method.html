---
layout: post
title: Using the Ruby Inject method
tags:
- inject
- Programming
- ruby
status: publish
type: post
published: true
meta:
  _edit_last: '1'
  dsq_thread_id: '720542505'
  _wp_old_slug: using-sql-inject-method
---
I have been working on creating dashboards for the past week and got learn how to use Ruby's inject method to get column totals.
<br/><br/>
Normally I would try to get the sum through sql, putting the work load on the database instead of my application. But in this case I'm going to take the data that I'm getting for each row and add it up to get the total.
<br/><br/>
Per apidock.com's <a href="http://apidock.com/ruby/Enumerable/inject">documentation</a>:
<br/><br/>
<em>Combines all elements of enum by applying a binary operation, specified by a block or a symbol that names a method or operator.</em>
{% highlight ruby %}(5..10).inject</a> {|sum, n| sum + n }
#=> 45{% endhighlight %}
How I'm using it:
{% highlight ruby %}@column_total = @each_row.inject(0){|sum, n| n.subtotal + sum }{% endhighlight %}
In this case, sum is set to zero through inject(0) then each number of my array will be combined to give me the total.
<br/><br/>
It's very flexible and you can certainly manipulate it further. Include a turnary condition to check if one of the value is blank:
{% highlight ruby %}@column_total = @each_row.inject(0){|sum, n| ((n.discount.blank? || n.discount == 0) ? 0 : n.discount) + sum }.to_f{% endhighlight %}
Or do some calculations within the inject:
{% highlight ruby %}@column_total = @each_row.inject(0){|sum, n| (n.total - n.discount) + sum }.to_f{% endhighlight %}
I found inject to be very helpful to sum columns. In a future post I will write about the alternative method of map + sum. In the meantime, let me know how you use it and what you think about it.